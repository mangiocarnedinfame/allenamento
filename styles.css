/* ====== Palette & reset ====== */
:root{
  --bg-0:#0a0f14;
  --text:#e9eef4;
  --blue:#2e7bff;
  --track:#2a2f37;
  --green:#8ee88d;
  --salmon:#ff8a74;
  --prep:#8ab4f8;
}

*{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter, -apple-system, "SF Pro Display", system-ui, Roboto, Helvetica, Arial, sans-serif;
  color:var(--text);
  background: radial-gradient(1200px 800px at 50% -10%, #0b1420, var(--bg-0)) no-repeat;
}

/* ====== App ====== */
#app{
  min-height:100svh; display:flex; align-items:center; justify-content:center;
  padding: clamp(12px, 2.5vw, 24px);
}
.screen{width:100%; max-width:480px}
.screen:not(.active){display:none}

/* ====== Edit ====== */
.grid{
  display:grid; grid-template-columns:1fr 1fr; grid-gap: clamp(14px, 2.5vw, 24px);
  margin: 6svh 0 24px;
}
.dial{
  position:relative; aspect-ratio:1/1; border-radius:50%;
  background: radial-gradient(120px 120px at 50% 30%, #0e1620, #0a0f14);
  border:2px solid rgba(68,117,255,.25);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.02), 0 0 34px rgba(64,105,255,.15);
  overflow:hidden; display:flex; align-items:center; justify-content:center; cursor:pointer;
  transition:transform .25s ease;
}
.dial:active{transform:scale(.985)}
.dial .ring{position:absolute; inset:-1px; border-radius:50%; box-shadow:0 0 0 1.5px rgba(64,105,255,.55), inset 0 0 24px rgba(64,105,255,.12)}
.dial-inner{text-align:center}
.dial-title{font-weight:800; color:#c7d0da; font-size: clamp(17px, 2.8vw, 22px); margin-bottom:8px}
.dial-value{color:var(--blue); font-size: clamp(30px, 6.5vw, 42px); font-weight:900; text-shadow:0 10px 28px rgba(30,87,255,.35)}

.primary{
  width:70%; display:block; margin:22px auto 8px; padding:18px 26px;
  border-radius:14px; font-weight:800; font-size:clamp(18px, 4.2vw, 22px);
  color:#0a0f14; background:linear-gradient(#3b78ff,#2d6cff); border:none;
  box-shadow:0 14px 30px rgba(22,78,255,.35)
}
.hint{text-align:center; color:#a2aebb; margin-top:6px; font-size:14px}

/* Collasso verso il centro quando si avvia */
.collapsing .dial{
  transition: transform .6s cubic-bezier(.18,.8,.24,1), opacity .35s ease;
  transform: translate(var(--dx), var(--dy)) scale(.9); opacity:.1;
}
.collapsing .primary,.collapsing .hint{opacity:0; transition:opacity .25s ease}

/* ====== Run screen ====== */
#run-screen{text-align:center; padding-top: clamp(10px, 6svh, 30px)}
.phase{font-weight:900; font-size:clamp(48px, 12vw, 64px); margin-bottom:10px}
.ring-timer{width:min(84vw,360px); aspect-ratio:1/1; margin:10px auto 16px; position:relative; cursor:pointer}
.ring-timer .time{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:clamp(40px, 10vw, 60px)}
.ring-timer .svg{width:100%; height:100%}
.track{fill:none; stroke:var(--track); stroke-width:26; filter:url(#shadow)}
.progress{fill:none; stroke:var(--green); stroke-width:26; stroke-linecap:round; transform:rotate(-90deg); transform-origin:50% 50%}
.round{font-weight:800; font-size:clamp(22px,5.2vw,28px); margin-top:6px}
.touch-hint{color:#a2aebb; font-size:14px; margin-top:8px}

/* ====== Modal FULL SCREEN ====== */
.modal.hidden{display:none}
.modal{position:fixed; inset:0; z-index:50}
.modal .backdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.45);
  backdrop-filter: blur(8px) saturate(120%);
}

/* Il pannello occupa TUTTO lo schermo */
.sheet{
  position:absolute; inset:0; display:flex; flex-direction:column;
  /* padding con safe-area */
  padding: calc(18px + env(safe-area-inset-top)) 16px 0;
  background: linear-gradient(180deg, rgba(15,22,31,.96) 0%, rgba(11,17,24,.96) 100%);
}

/* Header in alto */
.sheet-header{padding: 6px 6px 10px}
.sheet-title{font-weight:800; font-size:34px; letter-spacing:.3px; color:#eef3f8}

/* Wheels FULL HEIGHT (lascia spazio solo ai bottoni) */
.wheels{
  flex:1;                       /* <-- prende tutto lo spazio disponibile */
  min-height:0;                 /* important per consentire overflow alla wheel */
  display:flex; gap:18px; justify-content:space-evenly;
  padding: 6px 2px 0;
}
#wheels-container{display:flex}
#wheel-rounds{display:none}
.wheel-col{flex:1; max-width:280px; display:flex; flex-direction:column; min-height:0}
.wheel-col.single{margin:0 auto}
.wheel-label{color:#cfd7df; margin: 8px 0 10px 14px; font-weight:800}

/* Wheel con contenuto che SCORRE a tutta altezza */
.wheel{
  --item-h:64px; --sel-h:calc(var(--item-h) + 22px);
  flex:1; min-height:0; height:auto;
  position:relative; overflow-y:auto; overscroll-behavior:contain; touch-action:pan-y;
  scroll-snap-type:y mandatory; scroll-behavior:smooth; border-radius:16px;
  border:1px solid rgba(255,255,255,.05);
  background: radial-gradient(120px 120px at 50% 0%, #0f1721 0%, #0b1118 60%) no-repeat,
              linear-gradient(#0c131a,#0c131a);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
}
.wheel::-webkit-scrollbar{display:none}

/* RETTANGOLO CENTRALE FISSO (bloccato) */
.wheel::before{
  content:""; position:absolute; left:10px; right:10px; top:50%;
  transform: translateY(-50%);                      /* <-- sempre al centro */
  height:var(--sel-h); border-radius:14px;
  border:1.5px solid rgba(255,255,255,.14);
  background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0) 55%);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.05), 0 8px 24px rgba(0,0,0,.45);
  pointer-events:none; z-index:3;                   /* sta sopra ai numeri */
}
/* Vignetta top/bottom (sotto al rettangolo) */
.wheel::after{
  content:""; position:absolute; inset:0; border-radius:16px; pointer-events:none;
  background: linear-gradient(to bottom, rgba(10,15,20,.85), transparent 18%, transparent 82%, rgba(10,15,20,.85));
  z-index:2;
}

/* Numeri */
.wheel-item{
  height:var(--item-h); display:flex; align-items:center; justify-content:center;
  scroll-snap-align:center; font-size:54px; font-weight:900; color:#8ea0b5; opacity:.55; z-index:1;
}
.wheel-item.active{color:#fff; opacity:1; text-shadow:0 10px 26px rgba(0,0,0,.7)}

/* Barra azioni fissa in basso */
.sheet-actions{
  margin-top:auto; padding: 12px 16px calc(12px + env(safe-area-inset-bottom));
  display:flex; align-items:center; justify-content:space-between; gap:14px;
  background: linear-gradient(180deg, transparent, rgba(0,0,0,.25) 70%);
}
.btn{border:none; font-weight:800}
.btn.link{background:transparent; color:#e3eaf3; padding:14px 8px; font-size:18px}
.btn.confirm{background:#fff; color:#0a0f14; padding:16px 22px; border-radius:14px; font-size:20px; min-width:42%}

/* Desktop nicety */
@media (min-width:900px){
  #app{max-width:520px}
}
